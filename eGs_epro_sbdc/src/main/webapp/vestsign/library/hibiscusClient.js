//version: 3.0.6_331e6a2b86348334847237d6bc92f6093fa07a28
//update: Fri Aug 30 10:40:38 2019 +0900

!function(e,t,i){var n,o="",a={},r={},s=0,d="not working";function c(){this.changePin=function(e,t,i,n,o){var a={},r={};a.operation="ChangePin",r.dn=e,r.oldpin=f(t),r.newpin=f(i),r.options=n,a.data=r,v(a,o)},this.deleteCertificate=function(e,t,i,n){var o={},a={};o.operation="DeleteCertificate",a.dn=e,a.pin=f(t),a.options=i,o.data=a,v(o,n)},this.generateSignature=function(e,t,i,n,o){var a={},r={};a.operation="GenerateSignature",void 0!==e&&(r.dn=e),void 0!==t&&(r.plain=f(t)),void 0!==i&&(r.pin=f(i)),void 0!==n&&(r.options=n),a.data=r,v(a,o)},this.getCertificate=function(e,t,i){var n={},o={};n.operation="GetCertificate",o.dn=e,o.options=t,n.data=o,v(n,i)},this.getCertificateList=function(e,t){var i={},n={};i.operation="GetCertificateList",n.options=e,i.data=n,v(i,t)},this.importCertificate=function(e,t,i,n,o,a,r){var s={},d={};s.operation="ImportCertificate",d.cert=f(e),d.key=f(t),d.kmCert=f(i),d.kmKey=f(n),d.pin=f(o),d.options=a,s.data=d,v(s,r)},this.importP12=function(e,t,i,n){var o={},a={};o.operation="ImportP12",a.pfx=f(e),a.pin=f(t),a.options=i,o.data=a,v(o,n)},this.verifyPin=function(e,t,i,n){var o={},a={};o.operation="VerifyPin",a.dn=e,a.pin=f(t),a.options=i,o.data=a,v(o,n)},this.setItem=function(e,t,i,n){var o={},a={};o.operation="SetItem",a.key=f(e),a.data=f(t),a.options=i,o.data=a,v(o,n)},this.getItem=function(e,t,i){var n={},o={};n.operation="GetItem",o.key=f(e),o.options=t,n.data=o,v(n,i)},this.removeItem=function(e,t,i){var n={},o={};n.operation="RemoveItem",o.key=f(e),o.options=t,n.data=o,v(n,i)},this.unSetMatchedContext=function(e,t,i){var n={},o={};n.operation="UnSetMatchedContext",void 0!==e&&(o.customSID=f(e)),void 0!==t&&(o.options=t),n.data=o,v(n,i)},this.setMatchedContext=function(e,t,i,n,o,a){var r={},s={};r.operation="SetMatchedContext",void 0!==e&&(s.customSID=f(e)),void 0!==t&&(s.pin=f(t)),void 0!==i&&(s.dn=i),void 0!==n&&(s.suffix=f(unescape(encodeURIComponent(n)))),void 0!==o&&(s.options=o),r.data=s,v(r,a)},this.makeCustomSession=function(e,t,i,n,o){var a={},r={};a.operation="MakeCustomSession",void 0!==e&&(r.customSID=f(e)),void 0!==t&&(r.dn=t),void 0!==i&&(r.pin=f(i)),void 0!==n&&(r.options=n),a.data=r,v(a,o)},this.ChannelEncryptionRandom=function(e,t){var i={};i.operation="ChannelEncryptionRandom",i.data={},v(i,t)},this.Issue=function(e,t,i,n,o){var a={},r={};a.operation="Issue",void 0!==e&&(r.ref=e),void 0!==t&&(r.auth=t),void 0!==i&&(r.pin=f(i)),void 0!==n&&(r.options=n),a.data=r,v(a,o)},this.Update=function(e,t,i,n,o,a){var r={},s={};r.operation="Update",void 0!==e&&(s.dn=e),void 0!==t&&(s.pin=f(t)),void 0!==i&&(s.newPin=f(i)),void 0!==n&&(s.reusePin=f(n)),void 0!==o&&(s.options=o),r.data=s,v(r,a)},this.Revoke=function(e,t,i,n){var o={},a={};o.operation="Revoke",void 0!==e&&(a.dn=e),void 0!==t&&(a.pin=f(t)),void 0!==i&&(a.options=i),o.data=a,v(o,n)},this.setDomain=p}function p(e,t){if(void 0!==e&&(o=e),"function"!=typeof t&&(t=function(){}),"ready"==d)t(!0);else{var i=document.createElement("img");"not working"==d&&(d="loading",i.addEventListener("error",function(e){t({error:r.NOT_Load,message:"hibiscus server not load"})}),i.addEventListener("load",function(e){d="ready",t(!0)}),i.src=o+"/logo.png"),(n=document.createElement("iframe")).id="hibiscusClient",n.name="hibiscusClient",n.style.display="none",n.src=o,document.body.appendChild(n),n.addEventListener("load",function(){window.addEventListener("message",u,!1),t()})}}function v(e,t){p(void 0,function(c){c?"ready"==d?function(){e.messageNumber=s,a[s]=t;try{n.contentWindow.postMessage(i.encrypt(JSON.stringify(e)),o+"/index.jsp"),s++}catch(e){d="not working",t({error:r.LOST_CONNECTION,message:"hibiscus lost server"})}}():t({error:r.LOST_CONNECTION,message:"hibiscus lost server"}):t(c)})}function u(e){var t,n;if(0!=!o.indexOf(e.origin)){try{console.log("server -> client::"+e.data),t=JSON.parse(i.decrypt(e.data))}catch(e){n={error:r.JSON_PARSE_ERROR,message:"json parse error"}}if(function(e){if("object"==typeof e&&null!=e&&void 0!==e.error&&"number"==typeof e.error&&void 0!==e.message&&"string"==typeof e.message)return!0;return!1}(t.data))n=t.data;else switch(t.operation){case"ChannelEncryptionRandom":i.setRandom(t.data.randomNumber),i.setSecKey([location.origin,e.origin]),n=!0;break;case"TestFunc":case"ChangePin":case"DeleteCertificate":case"GenerateSignature":case"GetCertificate":case"GetCertificateList":case"GetVersion":case"ImportCertificate":case"ImportP12":case"VerifyPin":case"SetItem":case"GetItem":case"RemoveItem":case"UnSetMatchedContext":case"SetMatchedContext":case"MakeCustomSession":case"Issue":case"Update":case"Revoke":n=t.data;break;default:n={error:r.NOT_OPERATION,message:"operation not matched"}}(0,a[t.messageNumber])(n)}}function f(e,t){for(var i,n,o,a="",r="",s=0,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s<e.length;)i=e.charCodeAt(s++),n=e.charCodeAt(s++),o=e.charCodeAt(s++),a+=d.charAt(i>>2),a+=d.charAt((3&i)<<4|n>>4),isNaN(n)?a+="==":(a+=d.charAt((15&n)<<2|o>>6),a+=isNaN(o)?"=":d.charAt(63&o)),t&&a.length>t&&(r+=a.substr(0,t)+"\r\n",a=a.substr(t));return r+=a}(c||{}).server=o,r.NOT_Load=43484501,r.LOST_CONNECTION=82821258,r.JSON_PARSE_ERROR=68045001,r.NOT_OPERATION=68045e3,r.LOADING=6804e4,void 0!==e?(vest.hibiscus={},vest.hibiscus=new c):(t.hibiscus={},t.hibiscus=new c)}("undefined"!=typeof vest&&"object"==typeof vest?vest:void 0,window,ChannelEncryptJS);